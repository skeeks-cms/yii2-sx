/*
 Copyright (c) 2010 SkeekS
 @license https://cms.skeeks.com/license/
 @author Semenov Alexander <semenov@skeeks.com>
*/
(function(c,h,f){if(c.Skeeks||c.sx)throw Error("Skeeks or sx object is already defined in global namespace.");var a=c.sx=c.Skeeks={};a._=f;a.$=h;a.createNamespace=function(b,d){d=d||a;for(var e=b.split("."),g=d,k=0,m=e.length;k<m;++k){var l=e[k];g[l]||(g[l]={});g=g[l]}return g};a.version="1.5.3";a._readyTrigger=!1;a._ready=function(){a._readyTrigger=!0;a.EventManager.trigger("ready")};a.isReady=function(){return a._readyTrigger};a.init=function(b){a.Config.mergeDefaults(b);a._ready()};a.onReady=function(b){a.isReady()?
b():a.EventManager.bind("ready",b);return this}})(window,jQuery,_);
(function(c,h){c.classes={};c.classes.Base=function(){};c.classes.Base.prototype.construct=function(){};c.classes.Base.prototype.applyParentMethod=function(f,a,b){f.prototype[a].apply(this,b||[])};c.classes.Base.extend=function(f){c.__isExtending=!0;var a=function(){};a.prototype=new this;var b=function(){if(!c.__isExtending){for(var e in f)if(f.hasOwnProperty(e)){var g=f[e];h.isFunction(g)||(b.prototype[e]=h.clone(g))}this.construct.apply(this,arguments)}};b.prototype=new a;for(var d in f)f.hasOwnProperty(d)&&
(a=f[d],h.isFunction(a)&&(b.prototype[d]=a));b.prototype.constructor=b;b.prototype.parentClass=this.prototype;b.extend=this.extend;b.prototype.parent=this.prototype;c.__isExtending=!1;return b}})(Skeeks,Skeeks._);
(function(c,h,f){c.createNamespace("classes",c);c.classes._Entity=c.classes.Base.extend({construct:function(a){this._opts=a||{};this._coreInit()},_coreInit:function(){this._validate();this._init()},_validate:function(){},_init:function(){},toArray:function(){return this._opts},merge:function(a){a=a||{};this._opts=f.extend(this._opts,a);return this},mergeDefaults:function(a){a=a||{};this._opts=f.extend(a,this._opts||{});return this},exist:function(a){return"undefined"==typeof this._opts[a]?!1:!0},
isset:function(a){return this.exist(a)},clear:function(){this._opts={}},get:function(a,b){return this.exist(a)?this._opts[a]:b},set:function(a,b){this._opts[a]=b;return this},hasOpt:function(a){return this.exist(a)},getOpt:function(a,b){return this.get(a,b)},setOpt:function(a,b){return this.set(a,b)},setOpts:function(a){this._opts=a;return this},getOpts:function(){return this.toArray()},mergeOpts:function(a){return this.merge(a)},defaultOpts:function(a){return this.mergeDefaults(a)},deleteOpt:function(a){delete this._opts[a];
return this}});c.classes.Entity=c.classes._Entity.extend({})})(sx,sx.$,sx._);
(function(c,h,f){c.createNamespace("classes",c);c.classes.EventManager=c.classes.Base.extend({_hooks:{},construct:function(a){this._opts=a||{};this._$=h("<div/>")},trigger:function(a,b){if(this._hooks[a]&&this._hooks[a].length)for(var d=0,e=this._hooks[a].length;d<e;++d){var g=this._hooks[a][d];if(f.isFunction(g)){g=g(b);if(!1===g)return this;b=g||b}}this._$.trigger.apply(this._$,[a,b]);return this},on:function(a,b){this._$.on(a,b);return this},off:function(a,b){this._$.off(a,b)},bind:function(a,
b){return this.on(a,b)},unbind:function(a,b){return this.off(a,b)},hook:function(a,b){this._hooks[a]||(this._hooks[a]=[]);this._hooks[a].push(b);return this},unhook:function(a,b){if(this._hooks[a]&&this._hooks[a].length)for(var d=0,e=this._hooks[a].length;d<e;++d)b==this._hooks[a][d]&&(this._hooks[a][d]=null);return this},hooks:function(){return this._hooks}});c.EventManager=new c.classes.EventManager})(Skeeks,Skeeks.$,Skeeks._);
(function(c,h,f){c.createNamespace("classes",c);c.classes._Config=c.classes.Entity.extend({_init:function(){this.mergeDefaults({env:"dev",lang:"ru",loadedTime:null,cookie:{namespace:"sx"}})},isDev:function(){return"dev"==this.get("env")?!0:!1},isProduct:function(){return"product"==this.get("env")?!0:!1}});c.classes.Config=c.classes._Config.extend();c.Config=new c.classes.Config})(Skeeks,Skeeks.$,Skeeks._);
(function(c,h,f,a){c.createNamespace("classes",c);c.createNamespace("classes._core",c);c.classes._Component=c.classes.Entity.extend({_coreInit:function(){var b=this;this._eventManager=null;this._validate();this._init();c.registerComponent(this);this._domReadyTrigger=this._windowReadyTrigger=0;this.onDomReady(function(){b._onDomReady()});this.onWindowReady(function(){b._onWindowReady()});h(f.bind(this._domReady,this));if("complete"==document.readyState)b._windowReady();else h(a).on("load",function(){b._windowReady()})},
_init:function(){},_onDomReady:function(){},_onWindowReady:function(){},_domReady:function(){this._domReadyTrigger=1;this.trigger("onDomReady",this)},onDomReady:function(b){1==this._domReadyTrigger?b(this):this.bind("onDomReady",b);return this},_windowReady:function(){this._windowReadyTrigger=1;this.trigger("onWindowReady",this)},onWindowReady:function(b){1==this._windowReadyTrigger?b(this):this.bind("onWindowReady",b);return this},getEventManager:function(){null===this._eventManager&&(this._eventManager=
new c.classes.EventManager);return this._eventManager},on:function(b,d){this.getEventManager().on(b,d);return this},off:function(b,d){this.getEventManager().off(b,d);return this},bind:function(b,d){return this.on(b,d)},unbind:function(b,d){return this.off(b,d)},trigger:function(b,d){this.getEventManager().trigger(b,d);return this},hook:function(b,d){this.getEventManager().hook(b,d);return this},unhook:function(b,d){this.getEventManager().unhook(b,d);return this},hooks:function(){return this.getEventManager().hooks()}});
c.classes.Component=c.classes._Component.extend({});c.components=[];c.registerComponent=function(b){if(!(b instanceof c.classes._Component))throw Error("Instance of sx.classes.Component was expected.");c.components.push(b);return b}})(sx,sx.$,sx._,window);
(function(c,h,f){c.createNamespace("classes",c);c.classes._Cookie=c.classes.Component.extend({construct:function(a,b){this._namespace=a||"";this.applyParentMethod(c.classes.Component,"construct",[b])},_init:function(){this.exist("globalNamespace")?(this._globalNamespace=this.get("globalNamespace"),this.deleteOpt("globalNamespace")):c.Config.get("cookie").namespace?this._globalNamespace=c.Config.get("cookie").namespace:this._globalNamespace=""},set:function(a,b,d){c.cookie.set(this._cookieName(a),
b,d);return this},get:function(a){return c.cookie.get(this._cookieName(a))},getAll:function(){var a={},b=c.cookie.getAll(),d=this.getPrefix();b&&f.each(b,function(e,g){if(g.substring(0,d.length)==d){var k=g.substring(d.length);a[k]=e}});return a},setNamespace:function(a){this._namespace=a;return this},getNamspace:function(){return this._namespace},getGlobalNamspace:function(){return this._globalNamespace},getFullNamespace:function(){return this.getGlobalNamspace()+"__"+this.getNamspace()},getPrefix:function(){return this.getFullNamespace()+
"__"},_cookieName:function(a){return this.getPrefix()+a}});c.classes.Cookie=c.classes._Cookie.extend({});c.cookie={_defaultOptions:{path:"/",expires:365},set:function(a,b,d){d=d||{};null===b&&(b="",d.expires=-1);var e="";d.expires&&("number"==typeof d.expires||d.expires.toUTCString)&&("number"==typeof d.expires?(e=new Date,e.setTime(e.getTime()+864E5*d.expires)):e=d.expires,e="; expires="+e.toUTCString());d=f.extend(this._defaultOptions,d);var g=d.path?"; path="+d.path:"",k=d.domain?"; domain="+d.domain:
"";d=d.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),e,g,k,d].join("")},get:function(a){var b=null;if(document.cookie&&""!=document.cookie)for(var d=document.cookie.split(";"),e=0;e<d.length;e++){var g=jQuery.trim(d[e]);if(g.substring(0,a.length+1)==a+"="){b=decodeURIComponent(g.substring(a.length+1));"true"===b?b=!0:"false"===b&&(b=!1);break}}return b},getAll:function(){var a={};if(document.cookie&&""!=document.cookie)for(var b=document.cookie.split(";"),d=0;d<b.length;d++){var e=
jQuery.trim(b[d]),g=c.helpers.String.strpos(e,"=",0);if(g){var k=decodeURIComponent(e.substring(g+1));e=decodeURIComponent(e.substring(0,g));"true"===k?k=!0:"false"===k&&(k=!1);a[e]=k}}return a}}})(sx,sx.$,sx._);
(function(c,h,f){c.createNamespace("classes",c);c.classes._AjaxHandler=c.classes.Component.extend({construct:function(a,b){if(!(a instanceof c.classes._AjaxQuery))throw Error("invalid ajaxQuery class");b=b||{};this._ajaxQuery=a;this.applyParentMethod(c.classes.Component,"construct",[b])},_init:function(){},getAjaxQuery:function(){return this._ajaxQuery}});c.classes.AjaxHandler=c.classes._AjaxHandler.extend({});c.classes._AjaxQuery=c.classes.Component.extend({_url:"",construct:function(a,b){this._url=
a;this.applyParentMethod(c.classes.Component,"construct",[b]);c.ajax.registerQuery(this);this._executing=0},_init:function(){var a=this,b=this.get("complete");null!==b&&(this.onComplete(b),this.set("complete",null));b=this.get("success");null!==b&&(this.onSuccess(b),this.set("success",null));b=this.get("error");null!==b&&(this.onError(b),this.set("error",null));this.onComplete(function(){a._executing=Number(a._executing-1);0>a._executing&&(a._executing=0)});b=this.get("done");null!==b&&this.done(b);
b=this.get("fail");null!==b&&this.fail(b);b=this.get("always");null!==b&&this.always(b);this._additional=null},execute:function(){var a=this;!0===this.get("allowCountExecuting",!0)&&(a._executing=Number(a._executing+1));var b=this.getOpts();this.trigger("beforeExecute");return h.ajax(this.getUrl(),b).done(function(d){a.trigger("done",d);a.trigger("success",{ajax:a,response:d})}).fail(function(d,e,g){d={sender:a,errorThrown:g,textStatus:e,jqXHR:d};a.trigger("fail",d);a.trigger("error",d)}).always(function(d){a.trigger("complete",
d);a.trigger("always",d)})},isExecuting:function(){return!!this._executing},getUrl:function(){return this._url},setUrl:function(a){this._url=a;return this},setData:function(a){this.set("data",a);return this},getData:function(a){return this.get("data",{})},mergeData:function(a){a=a||{};a=f.extend(this.getData(),a);this.setData(a);return this},getType:function(){return String(this.get("type"))},setType:function(a){this.set("type",String(a));return this},getSettings:function(){return this._opts},getAdditional:function(){return this._additional},
setAdditional:function(a){this._additional=a;return this},onSuccess:function(a){this.on("success",a);return this},onError:function(a){this.on("error",a);return this},onComplete:function(a){this.on("complete",a);return this},onBeforeSend:function(a){this.on("beforeExecute",a);return this},done:function(a){this.on("done",a);return this},fail:function(a){this.on("fail",a);return this},always:function(a){this.on("always",a);return this}});c.classes.AjaxQuery=c.classes._AjaxQuery.extend({});c.ajax={ajaxStart:"ajaxStart",
ajaxStop:"ajaxStop",ajaxSend:"ajaxSend",ajaxSuccess:"ajaxSuccess",ajaxError:"ajaxError",ajaxComplete:"ajaxComplete",queries:[],registerQuery:function(a){if(!(a instanceof c.classes._AjaxQuery))throw Error("Instance of sx.classes._AjaxQuery was expected.");this.queries.push(a);return a},hasExecutingQueries:function(){return!!f.size(this.getExecutingQueries())},getExecutingQueries:function(){return f.filter(this.queries,function(a){return a.isExecuting()})},init:function(){h(f.bind(this._onDomReady,
this))},_onDomReady:function(){var a=this;h(document).bind(a.ajaxStart,function(){c.EventManager.trigger(a.ajaxStart)}).bind(a.ajaxStop,function(){c.EventManager.trigger(a.ajaxStop)}).bind(a.ajaxSend,function(){c.EventManager.trigger(a.ajaxSend)}).bind(a.ajaxSuccess,function(){c.EventManager.trigger(a.ajaxSuccess)}).bind(a.ajaxError,function(){c.EventManager.trigger(a.ajaxError)}).bind(a.ajaxComplete,function(){c.EventManager.trigger(a.ajaxComplete)})},prepareGetQuery:function(a,b,d){d=d||{};f.extend(d,
{type:"GET",data:b,dataType:"json"});return new c.classes.AjaxQuery(a,d)},preparePostQuery:function(a,b,d){d=d||{};f.extend(d,{type:"POST",data:b,dataType:"json"});return new c.classes.AjaxQuery(a,d)},prepareQuery:function(a,b,d){d=d||{};b=b||{};a=a||"";f.extend(d,{data:b,dataType:"json"});return new c.classes.AjaxQuery(a,d)}};c.onReady(function(){c.ajax.init()})})(Skeeks,Skeeks.$,Skeeks._);